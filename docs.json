{"swagger":"2.0","info":{"description":"Rest API for DeployHandler project.","version":"1.0.0","title":"DeployHandler.js API","contact":{"email":"alekski64@icloud.com","url":"https://aleksandar.alfa-ing.com"},"license":{"name":"Apache 2.0","url":"http://www.apache.org/licenses/LICENSE-2.0.html"}},"tags":[{"name":"users","description":"Operations related to user registration and login."},{"name":"apps","description":"Operations related to users applications."},{"name":"stats","description":"Operations related to Server and Application statistics."},{"name":"todos","description":"Operations related to Users Todos."}],"paths":{"/users":{"post":{"tags":["users"],"summary":"Register an user.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"formData","name":"username","description":"Username for new account.","required":true,"type":"string"},{"in":"formData","name":"password","description":"Password for new account.","required":true,"type":"string"},{"in":"formData","name":"email","description":"E-mail for new account.","required":true,"type":"string"}],"responses":{"201":{"description":"New user object in response.","schema":{"$ref":"#/definitions/UserObject"}},"500":{"description":"Error while registrating user."}}}},"/users/login":{"post":{"tags":["users"],"summary":"Login user - get token.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"formData","name":"username","description":"Username for user to authenticate.","required":true,"type":"string"},{"in":"formData","name":"password","description":"Password for user to authenticate.","required":true,"type":"string"}],"responses":{"200":{"description":"User is logged in.Token and user id in response.","schema":{"$ref":"#/definitions/LoginObject"}},"401":{"description":"Invalid login credentials."},"500":{"description":"An error occurred while logging in."}}}},"/users/changepw":{"post":{"tags":["users"],"summary":"Change users password.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"formData","name":"current","description":"Current password (for security reasons).","required":true,"type":"string"},{"in":"formData","name":"new","description":"New password.","required":true,"type":"string"}],"responses":{"200":{"description":"Password has been changed.","schema":{"type":"object","properties":{"success":{"type":"boolean","example":true}}}},"401":{"description":"Token expired / Token not valid / Wrong current password."},"500":{"description":"An error occurred while changing password."}}}},"/users/forgotpw":{"post":{"tags":["users"],"summary":"Sends user Email with URL to reset password.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"formData","name":"username","description":"Users username to reset password for. (Either username or email is required)","required":false,"type":"string"},{"in":"formData","name":"email","description":"Users email to reset password for. (Either username or email is required)","required":false,"type":"string"}],"responses":{"200":{"description":"Password reset email has been sent","schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Password reset email has been sent to you."}}}},"404":{"description":"User with that username/email was not found."},"500":{"description":"Error while sending password reset email.","schema":{"type":"object","properties":{"success":{"type":"boolean","example":false},"message":{"type":"string","example":"Error while sending password reset email."}}}}}}},"/users/forgotpwaction":{"post":{"tags":["users"],"summary":"Set new password using token from forgotpw for user who requested it.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"query","name":"token","description":"Valid 5minute secure token","required":true,"type":"string"},{"in":"formData","name":"password","description":"New password.","required":true,"type":"string"},{"in":"formData","name":"password2","description":"New password verification.","required":true,"type":"string"}],"responses":{"200":{"description":"Password has been reset.","schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Password reset was successful."}}}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while setting new password."}}}},"/users/close-account":{"delete":{"tags":["users"],"summary":"Close users account. All Apps,Todos and other data will be deleted.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"}],"responses":{"200":{"description":"Account has been closed","schema":{"type":"object","properties":{"message":{"type":"boolean","example":"Sorry to see you leaving. Have a good one."}}}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while closing acount."}}}},"/apps":{"get":{"tags":["apps"],"summary":"Get user's app list.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"}],"responses":{"200":{"description":"Returns array of apps.","schema":{"$ref":"#/definitions/AppArray"}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while getting app list."}}},"post":{"tags":["apps"],"summary":"Add new app.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"formData","name":"name","description":"Name for new app.","required":true,"type":"string"},{"in":"formData","name":"entryPoint","description":"Entry point to load app. (either file name like server.js or NPM command like start (to use npm command you have to set isNpm to true))","required":true,"type":"string"},{"in":"formData","name":"isNpm","description":"Boolean to set if app is started with NPM command","required":false,"type":"boolean"},{"in":"formData","name":"port","description":"Port that app uses.","required":true,"type":"string"}],"responses":{"201":{"description":"App added successfully.","schema":{"$ref":"#/definitions/AppObject"}},"401":{"description":"Token expired / Token not valid."},"404":{"description":"Could not find user with that ID."},"500":{"description":"An error occurred while adding app."}}}},"/apps/{appId}":{"get":{"tags":["apps"],"summary":"Get app with id from path parameter.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"}],"responses":{"200":{"description":"Returns app details.","schema":{"$ref":"#/definitions/AppObject"}},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while getting app details."}}},"put":{"tags":["apps"],"summary":"Update app with id from path parameter.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"},{"in":"formData","name":"name","description":"New name for app.","type":"string"},{"in":"formData","name":"entryPoint","description":"New entry point to load app.","type":"string"},{"in":"formData","name":"port","description":"New port that app uses.","type":"string"}],"responses":{"200":{"description":"Returns app new details.","schema":{"$ref":"#/definitions/AppObject"}},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while getting app details."}}},"delete":{"tags":["apps"],"summary":"Delete app with id from path parameter.","parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"}],"responses":{"200":{"description":"App has been deleted."},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while deleting app."}}}},"/apps/{appId}/start":{"post":{"tags":["apps"],"summary":"Start app with id from path parameter.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"}],"responses":{"200":{"description":"App has been started."},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while starting app."}}}},"/apps/{appId}/stop":{"post":{"tags":["apps"],"summary":"Stop app with id from path parameter.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"}],"responses":{"200":{"description":"App has been stopped."},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while starting app."}}}},"/apps/{appId}/install":{"post":{"tags":["apps"],"summary":"Installs app dependencies using npm.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"appId","description":"ID of app.","required":true,"type":"string"}],"responses":{"200":{"description":"Dependencies installed successfully / Dependencies are already installed.","schema":{"type":"object","properties":{"output":{"type":"string","example":"npm install command output"}}}},"401":{"description":"App does not belong to user from token / Token expired / Token not valid."},"404":{"description":"App with that ID was not found."},"500":{"description":"An error occurred while installing dependencies."}}}},"/stats":{"get":{"tags":["stats"],"summary":"Get server cpu and ram usage, get users total app number and running app number.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"}],"responses":{"200":{"description":"Returns JSON object.","schema":{"$ref":"#/definitions/StatsObject"}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while getting stats."}}}},"/todos":{"get":{"tags":["todos"],"summary":"Get users Todos list.","produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"}],"responses":{"200":{"description":"Returns array of Todos.","schema":{"$ref":"#/definitions/TodoArray"}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while getting todos."}}},"post":{"tags":["todos"],"summary":"Add new Todo.","consumes":["application/x-www-form-urlencoded"],"produces":["application/json"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"formData","name":"message","description":"Todo body message.","required":true,"type":"string"}],"responses":{"201":{"description":"Todo has been added!","schema":{"$ref":"#/definitions/TodoObject"}},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while adding Todo."}}},"delete":{"tags":["todos"],"summary":"Wipe all users Todos.","parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"}],"responses":{"200":{"description":"All Todos have been wiped."},"401":{"description":"Token expired / Token not valid."},"500":{"description":"An error occurred while wiping Todos."}}}},"/todos/{todoId}":{"put":{"tags":["todos"],"summary":"Set isComplete on Todo with id from path parameter.","produces":["application/json"],"consumes":["application/x-www-form-urlencoded"],"parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"todoId","description":"ID of todo.","required":true,"type":"string"},{"in":"formData","name":"complete","description":"New todo status (true/false).","type":"boolean"}],"responses":{"200":{"description":"Todo has been updated!"},"401":{"description":"Todo does not belong to user from token / Token expired / Token not valid."},"404":{"description":"Todo with that ID was not found."},"500":{"description":"An error occurred while getting todo details."}}},"delete":{"tags":["todos"],"summary":"Delete Todo with id from path parameter.","parameters":[{"in":"query","name":"token","description":"Valid user's token","required":true,"type":"string"},{"in":"path","name":"todoId","description":"ID of Todo.","required":true,"type":"string"}],"responses":{"200":{"description":"Todo has been deleted."},"401":{"description":"Todo does not belong to user from token / Token expired / Token not valid."},"404":{"description":"Todo with that ID was not found."},"500":{"description":"An error occurred while deleting Todo."}}}}},"definitions":{"UserObject":{"type":"object","required":["username","password","email"],"properties":{"_id":{"type":"string","example":"5946de802f6f160ff5fd3f71"},"username":{"type":"string","example":"alekB"},"password":{"type":"string","example":"$2a$10$wY1tB13ETLC.bmni7XQZXuMcfYu.GyafU3gOLkwrfHeP7oLA4h9Ym"},"email":{"type":"string","example":"alekb@deployhandler.com"},"apps":{"type":"array"},"createdDate":{"type":"string","format":"int32","example":"2017-06-18T20:11:44.306Z"}}},"LoginObject":{"type":"object","properties":{"message":{"type":"string","example":"Successfully logged in."},"token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7Il9pZCI6IjU5NDdkZDBlYjM4ZjdlMDc2MGQyYjIzNCIsInVzZXJuYW1lIjoiYmF0aWNhIiwicGFzc3dvcmQiOiIkMmEkMTAkRU1JSVFRc3ZFSS5uS3ozWkxHdFBBdU1XNlBKZEpYOEFOc3dvdXEwTEVSWmgxcHVMcnV2dnkiLCJlbWFpbCI6ImJhdGljYUBkZXBsb3loYW5kbGVyLmNvbSIsIl9fdiI6MCwiYXBwcyI6W10sImNyZWF0ZWREYXRlIjoiMjAxNy0wNi0xOVQxNDoxNzo1MC45MDFaIn0sImlhdCI6MTQ5Nzg4MTkxOCwiZXhwIjoxNDk3ODg5MTE4fQ.BId87RuBb12X-beajJXEfoM6jnK10_sGxV4vHCTHgH8"},"userId":{"type":"string","example":"5947dd0eb38f7e0760d2b234"}}},"AppObject":{"type":"object","required":["name","port","entryPoint"],"properties":{"_id":{"type":"string","example":"5946de802f6f160ff5fd3f71"},"name":{"type":"string","example":"eventPlanner"},"status":{"type":"string","example":"started"},"entryPoint":{"type":"string","example":"server.js"},"port":{"type":"string","example":8081},"user":{"type":"string","example":"5946de802f7f160ff2fd3j23"},"createdDate":{"type":"string","format":"int32","example":"2017-06-18T20:11:44.306Z"}}},"AppArray":{"type":"array","items":{"required":["name","port","entryPoint"],"properties":{"_id":{"type":"string","example":"5946de802f6f160ff5fd3f71"},"name":{"type":"string","example":"eventPlanner"},"status":{"type":"string","example":"started"},"entryPoint":{"type":"string","example":"server.js"},"port":{"type":"string","example":8081},"user":{"type":"string","example":"5946de802f7f160ff2fd3j23"},"createdDate":{"type":"string","format":"int32","example":"2017-06-18T20:11:44.306Z"}}}},"StatsObject":{"type":"object","properties":{"cpu":{"type":"object","properties":{"load":{"type":"number","description":"Cpu load","example":0.03},"usage":{"type":"number","description":"Cpu usage in %","example":50}}},"ram":{"type":"object","properties":{"total":{"type":"number","description":"Total amount of RAM in Megabytes","example":16384},"free":{"type":"number","description":"Amount of free RAM in Megabytes","example":3597},"usage":{"type":"number","description":"RAM usage in %","example":50}}},"apps":{"type":"object","properties":{"total":{"type":"number","description":"Total number of user's apps","example":15},"running":{"type":"number","description":"Number of user's apps that are started","example":5}}}}},"TodoObject":{"type":"object","required":["message"],"properties":{"_id":{"type":"string","example":"5946de802f6f160ff5fd3f71"},"message":{"type":"string","example":"Make new awesome app"},"isComplete":{"type":"boolean","example":false},"user":{"type":"string","example":"5946de802f7f160ff2fd3j23"}}},"TodoArray":{"type":"array","items":{"$ref":"#/definitions/TodoObject"}}},"schemes":["https","http"],"host":"deployhandler.com:3000","basePath":"/api"}